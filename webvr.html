<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="utf-8"/>
    <title>Babylon V4.1 - Test</title>
    <!--- Link to the last version of BabylonJS --->
    <script src="https://cdn.babylonjs.com/babylon.js"></script>

    <!--
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="lib/babylon_4.0/babylon.max.js"></script>
    <script src="lib/babylon_4.1/babylon.js"></script>
    --->

    <style>
        html, body {
            overflow: hidden;
            width   : 100%;
            height  : 100%;
            margin  : 0;
            padding : 0;
        }

        #renderCanvas {
            width   : 100%;
            height  : 100%;
            touch-action: none;
        }
    </style>
</head>
<body>
    <canvas id="renderCanvas"></canvas>
    <script>


    console.log("xr",navigator.xr)
    console.log(window.location.protocol, window.location.protocol=="https:")

    var webxrOk = navigator.xr!==undefined;
    var httpsOk = window.location.protocol=="https:";

    if(httpsOk) {
        if(webxrOk) console.log("1) WebXR and https are ok")
        else              alert("A) NO WebXR! No VR-Symbol");
    } else {
        if(webxrOk)       alert("B) NO https! WebXR disabbled, XR-Symbol to Cardboard mode only; Orientation may NOT run!");
        else              alert("2) NO https and no WebXR! No VR-Symbol");
    }

    /**/
    // To see errors on touch devices, activate this Errorhandler producing Galert dialogs
    window.onerror = function(msg,url,line){
        alert(msg+'\n'+url+'\nLine: '+line)
        return true
    }
    /**/

     window.addEventListener('DOMContentLoaded', function(){
         //error-test

         // get the canvas DOM element
         var canvas = document.getElementById('renderCanvas');

         // load the 3D engine
         var engine = new BABYLON.Engine(canvas, true);

         // createScene function that creates and return the scene
         var createScene = function(){
             // create a basic BJS Scene object
             var scene = new BABYLON.Scene(engine);

              var box = BABYLON.MeshBuilder.CreateBox("box", {});

              scene.createDefaultCameraOrLight(true, true, true) // auto view to existing objects
             var environment = scene.createDefaultEnvironment({ enableGroundShadow: true });

              // Enable VR/XR  (addon sim nur nach Tab-Reset und Zeit!)
             var vrHelper = scene.createDefaultVRExperience({createDeviceOrientationCamera:false});

              // return the created scene
             return scene;
         }

          // call the createScene function
         var scene = createScene();

          // run the render loop
         engine.runRenderLoop(function(){
             scene.render();
         });

          // the canvas/window resize event handler
         window.addEventListener('resize', function(){
             engine.resize();
         });
     });
    </script>
</body>
</html>
